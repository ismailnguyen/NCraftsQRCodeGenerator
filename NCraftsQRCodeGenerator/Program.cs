using Newtonsoft.Json;
using System;
using System.Net;

namespace NCraftsQRCodeGenerator
{
    class Program
    {
        static void Main(string[] args)
        {
            var myJsonString = "[{'speakerName':'Abeba Birhane','formUrl':'https://docs.google.com/forms/d/1kknKM-6fIrgWr2NVlCmw4Sgdcbg13tUPAZlglTgt4b8/viewform'},{'speakerName':'Mathias Verraes WORKSHOP','formUrl':'https://docs.google.com/forms/d/1ORYsLo5LHq6L2RquFrnoDQHoAd1_NtK1OscUohr2KbA/viewform'},{'speakerName':'Yoan Thirion & Cédric Tamavond','formUrl':'https://docs.google.com/forms/d/1AHEYeF3sM5mz7Z_YekG2gy191oQjuy56yrigwhPQ9ZI/viewform'},{'speakerName':'Woody Zuill WORKSHOP','formUrl':'https://docs.google.com/forms/d/1kblDT4zFBkIDDzLCUDwIP3N2y-Wb6n6v_dJWiz1qyHY/viewform'},{'speakerName':'Mathias Verraes','formUrl':'https://docs.google.com/forms/d/14l6c0yf8bkSCZCRfThIx_V5_9M5RW2xxrIhW2rfjg08/viewform'},{'speakerName':'Kenny Baas-Schwegler, Bruno Boucard & Thomas Pierrain WORKSHOP','formUrl':'https://docs.google.com/forms/d/1Cd-lxHV0A8BifqPSN4AA9VQCK513x-suhnYw00ED4EE/viewform'},{'speakerName':'Kevlin Henney WORKSHOP','formUrl':'https://docs.google.com/forms/d/1g5He6AECnsmQkv910jBdo0s_-5NaMewjJkqUrCZG4p8/viewform'},{'speakerName':'Thomas Bracher','formUrl':'https://docs.google.com/forms/d/1HNXqLSBMQ4--BUqq8KRxB948kAS9wrG8yU6ywgELB9I/viewform'},{'speakerName':'Woody Zuill','formUrl':'https://docs.google.com/forms/d/1C8c9X4Yn7fYNMO1A6Kp1PAo3fg3G9f8y2JeoDBJXBXM/viewform'},{'speakerName':'Cédric Tamavond','formUrl':'https://docs.google.com/forms/d/1fIuvkF9pb9e7N27m8nqpGNwB5YlFxlzusy5wdBTuEpU/viewform'},{'speakerName':'Pascal Le Merrer','formUrl':'https://docs.google.com/forms/d/17j9iYLyq93VdYKkD153kEykyULbwAfsPDT4X87lBy6k/viewform'},{'speakerName':'Michelle Avomo','formUrl':'https://docs.google.com/forms/d/1EjMoHdXNLtH3dQ0ClR7nR1oVLqxei-xU_hyxrvmyu0k/viewform'},{'speakerName':'Frédéric Rivain','formUrl':'https://docs.google.com/forms/d/1daGVV2qo1KD2rcfNIiynVsi3RRloZ3NLbEJuU9Csuy0/viewform'},{'speakerName':'Julien Lavigne du Cadet','formUrl':'https://docs.google.com/forms/d/1IWkP0piRqwNM2WnjO1JNeFfh2rEwM7IXQ5b6V4bMrko/viewform'},{'speakerName':'Marit van Dijk','formUrl':'https://docs.google.com/forms/d/1WyJWAODxMjAxmOFeWOigFLZVwkpxYK3hpW1rh18CT5w/viewform'},{'speakerName':'Emily Bache','formUrl':'https://docs.google.com/forms/d/1883BsALpqK4gP4dqnKzGyemiwcNL8PbYCjHX7rmtujI/viewform'},{'speakerName':'Alex Petrov','formUrl':'https://docs.google.com/forms/d/1EVwfk3uXQiUhF3C3xODqEf10wjhI8wOMTbrwlWN5tBg/viewform'},{'speakerName':'Sara Vieira','formUrl':'https://docs.google.com/forms/d/1qZMYxQqOm2Gq4SvzySafSaNUJzVnm3W5VYzcD0JXJfA/viewform'},{'speakerName':'Thomas Garus','formUrl':'https://docs.google.com/forms/d/1j57IqLrDGZiRje_ijcMSMa2ZwAHP-wMc-FfQ8EyM6Hc/viewform'},{'speakerName':'Alexandra Schladebeck','formUrl':'https://docs.google.com/forms/d/1Chcc51qfYUcidhsehCgcQWmhprs4EfyQQy5oNZbvhtQ/viewform'},{'speakerName':'Kenny Baas-Schwegler','formUrl':'https://docs.google.com/forms/d/1bW_q_ybxqDF_Zgjb5rTe1UdP1nYzlylHCJzyAjuemIw/viewform'},{'speakerName':'Indu Alagarsamy','formUrl':'https://docs.google.com/forms/d/17by-7xGi15Zs7TqEW_74HSretcAZ8MAJz8xg9z7HSkY/viewform'},{'speakerName':'Cyrille Martraire','formUrl':'https://docs.google.com/forms/d/1QcGvgQ-iMZAdqhZi8xaJKQ2viCw9-OazSyy14iRuvAQ/viewform'},{'speakerName':'Eveyln Van Kelle','formUrl':'https://docs.google.com/forms/d/1H8rZNRJvDqB4yP0AqKFb97QFw8OZMdE_EdQnz5mzLgg/viewform'},{'speakerName':'Marco Heimeshoff','formUrl':'https://docs.google.com/forms/d/1S6fY-sKO7R_7faL1EbFIfVld1cpwbSfmLI1xHEiXunY/viewform'},{'speakerName':'Nolen Gertz','formUrl':'https://docs.google.com/forms/d/1T4tVOfIrbnnPSLWPqq9jivOhSAylHR32hzMAbScKzOo/viewform'},{'speakerName':'Alvaro Videla','formUrl':'https://docs.google.com/forms/d/10ZBJ0l8qOSYIjPPTHnApqNaUoo1dDS0j_4VUfdDzcvM/viewform'},{'speakerName':'Brian Marick','formUrl':'https://docs.google.com/forms/d/1APpLBHQNMP1hstLBbOP2HD2UjEBwrRsQ56_lcPmLhaI/viewform'},{'speakerName':'Tomas Petricek','formUrl':'https://docs.google.com/forms/d/1oOqPWl16c7duGEeRYjiB7nT7gEev5e8229iOM-Dh41M/viewform'},{'speakerName':'Scott Wlaschin','formUrl':'https://docs.google.com/forms/d/1li44cHka7uv82r9rsM0RXmsq68j0PbPU9m3ra968lhA/viewform'},{'speakerName':'April Wensel','formUrl':'https://docs.google.com/forms/d/1bcm85ovb_1bvjPqveMe3-TnVtcD08sh9GSsJscFB_f0/viewform'},{'speakerName':'Johan Martinsson','formUrl':'https://docs.google.com/forms/d/1WXb600SwALWeIjV4n62BECb-xJnI7TzggfPZNlRQYTE/viewform'},{'speakerName':'Marijn Huizendveld','formUrl':'https://docs.google.com/forms/d/1BICMa701ziuQL_e3nXwjA65aGkjL94AG-4vN1iuT7EQ/viewform'},{'speakerName':'Gien Verschatse','formUrl':'https://docs.google.com/forms/d/1csYDyBAht267yxgofuhEkDxHPiEbdsk_k2J8ggbqDq4/viewform'},{'speakerName':'Dennis Doomen','formUrl':'https://docs.google.com/forms/d/1eY-7xsfCm5OokhlgRRM2Bbb4SyHwOFDw4rEP1B3yulc/viewform'},{'speakerName':'Dorra Bartaguiz','formUrl':'https://docs.google.com/forms/d/1GzkmAh8haIvsSVUHTrjc_kz7K7MS5Gjg1c0Jb09bYYk/viewform'},{'speakerName':'Jean Paliès','formUrl':'https://docs.google.com/forms/d/1_SefEeqavlpotW5yROIY7iwoZLMnNF_7s45dulLaqso/viewform'},{'speakerName':'Estelle Landry','formUrl':'https://docs.google.com/forms/d/1TR11xiuYA8hp2N7dEnO0Adv7ZC8qLWfYjjeov7Ub-Kc/viewform'},{'speakerName':'Eric Lefevre-Ardant','formUrl':'https://docs.google.com/forms/d/19MBNsJ2NZiYgEyzx22J8zly9nRoCGSfA5fi4luHAyaQ/viewform'},{'speakerName':'Romeu Moura','formUrl':'https://docs.google.com/forms/d/1Cvf8bwiU7iIR1ARvj4G7D1XDMP1Ke-HjQDMG1m3OXQo/viewform'},{'speakerName':'Tobias Goeschel','formUrl':'https://docs.google.com/forms/d/1GU-r5p2vQnsXeUtA4lsaPWafuqEI7bzIQxbnbC_W37k/viewform'},{'speakerName':'Steve Smith','formUrl':'https://docs.google.com/forms/d/1K4KI2F5SXbadTIge_jLANffcnEXhSAkkinK3J2oOSc4/viewform'},{'speakerName':'Sabrina Leandro','formUrl':'https://docs.google.com/forms/d/1bS0kYVi3WWZo4X-UDN6w1lTCRRHIKYVUxX4OAmJSbXQ/viewform'},{'speakerName':'Kevlin Henney','formUrl':'https://docs.google.com/forms/d/1wZV3TYSC67FSE8HU5XC4cdpOIOpRu9azfNmYBwahNAc/viewform'},{'speakerName':'Patrick Kua','formUrl':'https://docs.google.com/forms/d/1Qr8EIDDOwPIgHqrEab2J71Vqy5eIeZjAuxNK9Jz79g8/viewform'},{'speakerName':'Xavier Detant','formUrl':'https://docs.google.com/forms/d/18fzYDcBoZwSK9SidEk6Y9L3DN5GDgdKkRwdtOPxSKW4/viewform'},{'speakerName':'Matthias Noback','formUrl':'https://docs.google.com/forms/d/11NTR8DGmiPisbvNb8F76IsFQv7RlLko4CQzyzVYd6Ac/viewform'},{'speakerName':'Aki Salmi','formUrl':'https://docs.google.com/forms/d/10VBKG0Rn0m1lX_ap2wZJrvW7H48bDA_IsrorWXVBeyQ/viewform'},{'speakerName':'Anna Savarin','formUrl':'https://docs.google.com/forms/d/1e4pM-FsxrF74ElkPSRFEwAzGTz0xKd9FEaDrxWDWaMk/viewform'},{'speakerName':'Gwen Diagram','formUrl':'https://docs.google.com/forms/d/1V4rTSwtlmHVuLgu6Lk2RIv2f27lcBNw_3gpAGeHsZHo/viewform'},{'speakerName':'Clément Delafargue','formUrl':'https://docs.google.com/forms/d/1sgdNos7oexybBwQV_XpU4ckKJnQ14NsAUM5d2-WF2Sw/viewform'},{'speakerName':'Ulrika Malmgren','formUrl':'https://docs.google.com/forms/d/1p8dVvdi8rXWP62X6oBWF3LawGcqyB3yPl2Mh6b1Ub6I/viewform'},{'speakerName':'Alberto Brandolini','formUrl':'https://docs.google.com/forms/d/1mO2X2J6neYLhm9WyX2v_Tk7wXwnc2Gxd3mAb1-wqS_s/viewform'},{'speakerName':'Helen Leigh','formUrl':'https://docs.google.com/forms/d/1foot2k4f3lzR7m1Ne31kkDXIOlA5R2ki0H02UUzYn00/viewform'},{'speakerName':'Emanuela Damiani','formUrl':'https://docs.google.com/forms/d/1otsbF6JMpIqEm8T-QT2Y7r6kM9Drq3Xcy5b-Q0p1LVM/viewform'},{'speakerName':'Jérémie Chassaing','formUrl':'https://docs.google.com/forms/d/1eO4GLx7RjX63QovONlITO3xgtoR0LJvk2xaBcS-o17U/viewform'},{'speakerName':'Einar Høst','formUrl':'https://docs.google.com/forms/d/1Zufv6CzLfRbsBJujDWk3Ou-r2kpKwJAthMZKIL6Sx70/viewform'},{'speakerName':'Samir Talwar','formUrl':'https://docs.google.com/forms/d/1PcW47lLihJb_3EHf3nqbFDVi7j_Vudwun9NRY6AfMEU/viewform'}]";

            FeedbackForm[] feedbackForms =  JsonConvert.DeserializeObject<FeedbackForm[]>(myJsonString);

            WebClient webClient = new WebClient();
            foreach(var form in feedbackForms)
            {
                var fileName = $"{ form.speakerName.Replace(" ", "_") }.png";
                var fileUrl = $"https://api.qrserver.com/v1/create-qr-code/?size=600x600&margin=1&data={ form.formUrl }";

                webClient.DownloadFile(fileUrl, fileName);

                Console.WriteLine($"Downloading { fileName } (from { fileUrl })");
            }

            Console.ReadKey();
        }

        public class FeedbackForm
        {
            public string speakerName;
            public string formUrl;
        }
    }
}
